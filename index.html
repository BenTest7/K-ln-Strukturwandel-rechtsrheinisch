
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Strukturwandel Köln – Interaktive Karte</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
  html, body { height: 100%; margin: 0; padding: 0; }
  #map { height: 100vh; width: 100%; }
  h2 { text-align: center; font-family: Arial, sans-serif; margin: 5px 0; }
  p { text-align: center; font-family: Arial, sans-serif; margin: 5px 0 10px 0; }
  button {
    display: block;
    width: 100%;
    margin: 2px 0;
    padding: 6px 12px;
    font-size: 14px;
    cursor: pointer;
  }
</style>
</head>
<body>

<h2>Interaktive Karte: Strukturwandel Köln rechtsrheinisch</h2>
<p>Tippe auf ein Gebiet, wähle die aktuelle Hauptrolle – die Farbe wird automatisch angepasst.</p>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>

// Karte initialisieren, Zoom auf Mülheim/Deutz
var map = L.map('map').setView([50.945, 6.995], 15);

// Hintergrundkarte OpenStreetMap
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '© OpenStreetMap-Mitwirkende'
}).addTo(map);

// Farben für Rollen
var roleColors = {
    "Industrie": "blue",
    "Start-ups / Dienstleistungen": "yellow",
    "Wohnen / Gentrifizierung": "red",
    "Freizeit / Kultur": "green"
};

// Gebiete (Polygone) mit Koordinaten
var areas = [
  {name: "Deutz", coords:[[50.9407,6.995],[50.9407,6.985],[50.933,6.985],[50.933,6.995]]},
  {name: "Carlswerk", coords:[[50.956,7.013],[50.956,7.021],[50.950,7.021],[50.950,7.013]]},
  {name: "Schanzenstraße", coords:[[50.955,7.008],[50.955,7.012],[50.952,7.012],[50.952,7.008]]},
  {name: "Messe/Lanxess-Arena", coords:[[50.940,6.975],[50.940,6.985],[50.935,6.985],[50.935,6.975]]}
];

// Objekt zum Speichern der Polygon-Layer
var polygonLayers = {};

// Funktion Pop-up erstellen
function createPopup(layer) {
    var popupContent = "<b>"+layer.feature.properties.name+"</b><br/>Wähle die Hauptrolle:<br/>";
    for (var role in roleColors) {
        popupContent += "<button onclick='setRole(""+layer.feature.properties.name+"",""+role+"")'>"+role+"</button>";
    }
    layer.bindPopup(popupContent, {autoClose: true});
}

// Funktion zum Setzen der Rolle (Farbe)
function setRole(areaName, role) {
    var layer = polygonLayers[areaName];
    if(layer) {
        layer.setStyle({fillColor: roleColors[role], fillOpacity:0.6});
        layer.closePopup(); // Pop-up automatisch schließen
    }
}

// Polygone erzeugen
areas.forEach(function(a){
    var polygon = L.polygon(a.coords, {color:"black", fillColor:"white", fillOpacity:0.4}).addTo(map);
    polygon.feature = {properties:{name:a.name}};
    createPopup(polygon);
    polygonLayers[a.name] = polygon;
});

</script>
</body>
</html>
